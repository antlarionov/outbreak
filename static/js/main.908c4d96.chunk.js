(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{178:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(21),s=a.n(r),l=(a(71),a(3)),o=a(4),c=a(7),h=a(6),u=a(8),d=(a(43),a(9)),m=a(30),p=a.n(m),v=function(){function e(){Object(l.a)(this,e)}return Object(o.a)(e,null,[{key:"makeHex",value:function(e){var t=p()(e);return[t.red(),t.green(),t.blue()]}},{key:"makeRGB",value:function(e,t,a){return[e,t,a]}},{key:"makeHSL",value:function(e,t,a){var n=p.a.hsl(e,t,a);return[n.red(),n.green(),n.blue()]}},{key:"blend",value:function(e,t,a){return[(t[0]-e[0])*a+e[0],(t[1]-e[1])*a+e[1],(t[2]-e[2])*a+e[2]]}},{key:"withAlpha",value:function(e,t){return[e[0],e[1],e[2],t]}},{key:"r",value:function(e){return e[0]}},{key:"g",value:function(e){return e[1]}},{key:"b",value:function(e){return e[2]}},{key:"a",value:function(e){return 4===e.length?e[3]:255}},{key:"hue",value:function(e){var t=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.min(t,a,n),r=Math.max(t,a,n),s=NaN,l=r-i,o=(r+i)/2;return l?(s=t===r?(a-n)/l+6*(a<n):a===r?(n-t)/l+2:(t-a)/l+4,l/=o<.5?r+i:2-r-i,s*=60):l=o>0&&o<1?0:s,s}},{key:"__helperRep",value:function(t){return p.a.rgb(e.r(t),e.g(t),e.b(t),e.a(t))}},{key:"__fromHelperRep",value:function(e){return[e.red(),e.green(),e.blue()]}},{key:"hex",value:function(t){return e.__helperRep(t).toString()}},{key:"opacity",value:function(t){return e.a(t)/255}},{key:"lighten",value:function(t,a){return e.__fromHelperRep(e.__helperRep(t).whiten(a))}}]),e}(),y=function(){function e(){Object(l.a)(this,e)}return Object(o.a)(e,null,[{key:"assert",value:function(e,t){e||(console.log("ACK!",t),alert("ACK! "+t))}},{key:"makeImageUri",value:function(e){var t=-1,a=!0,n=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var l=r.value;l.length>t&&(t=l.length)}}catch(P){n=!0,i=P}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}for(var o=e.length,c=new Uint8ClampedArray(t*o*4),h=0;h<o;h++){for(var u=e[h].length,d=Math.floor((t-u)/2),m=t-u-d,p=0;p<u;p++){var y=e[h][p],f=4*(h*t+d+p);c[f]=v.r(y),c[f+1]=v.g(y),c[f+2]=v.b(y),c[f+3]=v.a(y)}for(var g=0;g<d;g++){var E=4*(h*t+g);c[E]=255,c[E+1]=255,c[E+2]=255,c[E+3]=255}for(var w=u+m;w<t;w++){var b=4*(h*t+w);c[b]=255,c[b+1]=255,c[b+2]=255,c[b+3]=255}}var S=document.createElement("canvas"),k=S.getContext("2d");S.width=t,S.height=o;var D=k.createImageData(t,o);return D.data.set(c),k.putImageData(D,0,0),S.toDataURL()}},{key:"arraysEqual",value:function(t,a){if(t.length!==a.length)return!1;for(var n=0;n<t.length;n++){var i=t[n],r=a[n],s=i===r;if(Array.isArray(i)&&Array.isArray(r)&&(s=e.arraysEqual(i,r)),!s)return!1}return!0}}]),e}(),f=a(65),g=a.n(f),E=function(){function e(t){Object(l.a)(this,e),null!==t&&void 0!==t||(t=Math.floor(Math.random()*e.m)),this.lastX=Math.floor(t)}return Object(o.a)(e,[{key:"random",value:function(){return this.lastX=(e.a*this.lastX+e.c)%e.m,this.lastX/e.m}},{key:"randBetween",value:function(e,t){return this.random()*(t-e)+e}},{key:"randIntBetween",value:function(e,t){var a=this.random()*(t-e+1);return Math.floor(a)+e}}]),e}();E.m=2147483648,E.a=214013,E.c=2531011;var w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).initializeFromProps(a.props,!0),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){this.initializeFromProps(e,!1)}},{key:"initializeFromProps",value:function(e,t){var a={};t?this.state=a:this.setState(a),null!==this.interval&&void 0!==this.interval&&clearInterval(this.interval),this.interval=setInterval(e.callback,e.milliseconds)}},{key:"render",value:function(){return null}}]),t}(n.Component);w.defaultProps={};var b=function e(){Object(l.a)(this,e)};b.SUSCEPTIBLE_COLOR="#EEE",b.EXPOSED_COLOR="#ffdde2",b.INFECTED_COLOR="#F44",b.ISOLATING_COLOR="#8094ff",b.REMOVED_COLOR="#999",b.DEAD_COLOR="#000",b.SUSCEPTIBLE=0,b.EXPOSED=1,b.INFECTED=2,b.REMOVED=3,b.DEAD=4;var S=function(){function e(t,a,n){Object(l.a)(this,e),this.r=a,this.c=n,this.state=b.SUSCEPTIBLE,this.nextState=b.SUSCEPTIBLE,this.daysInState=0,this.linked=!1,this.mediaOutlet=!1,this.specialDegree=null,this.dead=!1,this.isolating=!1,this.rng=t}return Object(o.a)(e,[{key:"getState",value:function(){return this.state}},{key:"getNextState",value:function(){return this.nextState}},{key:"isSusceptible",value:function(){return this.state===b.SUSCEPTIBLE}},{key:"isExposed",value:function(){return this.state===b.EXPOSED}},{key:"isInfected",value:function(){return this.state===b.INFECTED}},{key:"canInfectOthers",value:function(){return this.state===b.EXPOSED||this.state===b.INFECTED}},{key:"isRemoved",value:function(){return this.state===b.REMOVED}},{key:"isDead",value:function(){return this.state===b.DEAD}},{key:"isAllowedToBeRemoved",value:function(){return!this.linked}},{key:"_setState",value:function(e){this.state=e}},{key:"setNextState",value:function(e){this.nextState=e}},{key:"setSusceptible",value:function(){this._setState(b.SUSCEPTIBLE)}},{key:"setExposed",value:function(){this._setState(b.EXPOSED)}},{key:"setInfected",value:function(){this._setState(b.INFECTED)}},{key:"setRemoved",value:function(){this._setState(b.REMOVED)}},{key:"setDead",value:function(){this._setState(b.DEAD)}},{key:"startDay",value:function(){this.nextState=this.state}},{key:"isIsolating",value:function(){return this.isolating}},{key:"tryToInfect",value:function(e,t){if(e.isSusceptible()&&this.rng.random()<t){e.setNextState(b.EXPOSED)}}},{key:"maybeIsolate",value:function(e){this.rng.random()<e&&(this.isolating=!0)}},{key:"endDay",value:function(e,t,a,n,i,r){this.nextState!==this.state?(this.nextState===b.EXPOSED&&0===t&&(this.nextState=b.INFECTED,this.maybeIsolate(r)),this._setState(this.nextState),this.daysInState=0):(this.daysInState++,this.isExposed()?this.daysInState>=t&&(this.setInfected(),this.maybeIsolate(r),this.daysInState=0):this.isInfected()&&this.daysInState>=a&&(e&&(i*=2),n||(i=0),this.rng.random()<i?this.setDead():this.setRemoved(),this.daysInState=0))}}]),e}(),k=a(62),D=a(64),P=a.n(D),I=a(180),C=Object(I.withStyles)({root:{background:"linear-gradient(0deg, #f0f0f0 30%, #f8f8f8 90%)"},label:{textTransform:"capitalize"}})(P.a),O=Object(I.withStyles)({root:{background:"linear-gradient(0deg, #ccddff 30%, #ddeeff 90%)"},label:{textTransform:"capitalize"}})(C),R=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t={margin:"0.5rem"};return"small"===this.props.size&&(t={margin:"0.5rem",maxWidth:"30px",maxHeight:"30px",minWidth:"30px",minHeight:"30px"}),this.props.highlighted?i.a.createElement(O,{variant:"contained",onClick:function(t){t.preventDefault(),e.props.onClick(t)},style:t},this.props.children):i.a.createElement(C,{variant:"contained",onClick:function(t){t.preventDefault(),e.props.onClick(t)},style:t},this.props.children)}}]),t}(i.a.PureComponent),N=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=b.SUSCEPTIBLE_COLOR;return"exposed"===this.props.type?e=b.EXPOSED_COLOR:"infected"===this.props.type?e=b.INFECTED_COLOR:"removed"===this.props.type?e=b.REMOVED_COLOR:"dead"===this.props.type&&(e=b.DEAD_COLOR),i.a.createElement("div",{style:{marginBottom:"-2px",border:"1px black solid",width:"1rem",height:"1rem",backgroundColor:e,display:"inline-block"}})}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).width=null,a.height=150,a.canvasRef=i.a.createRef(),a.state={showDead:!0,showInfected:!0,showRecovered:!0},a.componentWillReceiveProps(e),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(d.a)(Object(d.a)(a))),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"updateWindowDimensions",value:function(){var e=Math.min(600,document.documentElement.clientWidth-60);this.width!==e&&(this.width=e,this.redraw())}},{key:"componentWillReceiveProps",value:function(e,t){this.updateMaxValues(e)}},{key:"updateMaxValues",value:function(e){this.maxValue=1;var t=[];this.state.showInfected&&t.push(e.infectedPerDay),this.state.showRecovered&&t.push(e.recoveredPerDay),this.state.showDead&&t.push(e.deadPerDay),e.hospitalCapacity>-1&&t.push(e.capacityPerDay);for(var a=0;a<e.infectedPerDay.length;a++)for(var n=0;n<t.length;n++){var i=t[n][a];null!==i&&i>this.maxValue&&(this.maxValue=i)}this.maxValue*=1.1,this.maxValue=this.props.population,this.maxDay=Math.max(e.infectedPerDay.length-1,1)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"showHospitalCapacity",value:function(){return this.props.hospitalCapacity>-1}},{key:"redraw",value:function(){if(null!==this.canvas&&void 0!==this.canvas){this.updateMaxValues(this.props);var e=this.canvas.getContext("2d");e.fillStyle=b.SUSCEPTIBLE_COLOR,e.fillRect(0,0,this.width,this.height),e.setLineDash([]),e.lineWidth=2;for(var t=[],a=[],n=[],i=[],r=[],s=[],l=0;l<this.props.infectedPerDay.length;l++){var o=l,c=this.props.infectedPerDay[o],h=this.props.recoveredPerDay[o],u=this.props.deadPerDay[o],d=(this.props.population,this.props.capacityPerDay[o]);null===c?(this.drawPath(t,a,e,b.INFECTED_COLOR),this.drawPath(a,n,e,"#A8A8A8"),this.drawPath(n,i,e,b.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(s,s,e,"#000"),t.length=0,a.length=0,n.length=0,i.length=0,r.length=0,s.length=0):(t.push([this.xcoord(o),this.ycoord(0)]),a.push([this.xcoord(o),this.ycoord(c)]),n.push([this.xcoord(o),this.ycoord(c+h)]),i.push([this.xcoord(o),this.ycoord(c+h+u)]),r.push([this.xcoord(o),this.ycoord(this.maxValue)]),s.push([this.xcoord(o),this.ycoord(d)]))}this.drawPath(t,a,e,b.INFECTED_COLOR),this.drawPath(a,n,e,"#A8A8A8"),this.drawPath(n,i,e,b.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(s,s,e,"#000");for(var m=0;m<this.props.infectedPerDay.length;m++){var p=m;null===this.props.infectedPerDay[p]&&(e.strokeStyle="#000",e.lineWidth=2,e.setLineDash([5,5]),this.drawLine(e,p-1,0,p-1,this.maxValue))}e.strokeStyle="#000",e.setLineDash([]),e.lineWidth=1,this.drawLine(e,0,0,0,this.maxValue),this.drawLine(e,0,0,this.maxDay,0)}}},{key:"drawPath",value:function(e,t,a,n){if(0!==e.length){a.beginPath(),a.moveTo(e[0][0],e[0][1]);for(var i=0;i<e.length;i++)a.lineTo(e[i][0],e[i][1]);if(e!==t)for(var r=t.length-1;r>=0;r--)a.lineTo(t[r][0],t[r][1]);e===t?(a.strokeStyle=n,a.lineWidth=2,a.setLineDash([5,5]),a.stroke()):(a.fillStyle=n,a.fill())}}},{key:"drawSeries",value:function(e,t){for(var a=1;a<e.length;a++){var n=a-1,i=a,r=e[n],s=e[i];null!==r&&null!==s&&this.drawLine(t,n,r,i,s)}}},{key:"xcoord",value:function(e){return this.width*e/this.maxDay}},{key:"ycoord",value:function(e){return(this.height-1)*(1-e/this.maxValue)}},{key:"drawBar",value:function(e,t,a,n,i){var r=this.xcoord(t),s=this.xcoord(n),l=this.ycoord(a),o=this.ycoord(i);e.fillRect(r,l,s-r,o-l)}},{key:"drawLine",value:function(e,t,a,n,i){e.beginPath(),e.moveTo(this.xcoord(t),this.ycoord(a)),e.lineTo(this.xcoord(n),this.ycoord(i)),e.stroke()}},{key:"resetArrays",value:function(){this.props.capacityPerDay.length=0,this.props.deadPerDay.length=0,this.props.infectedPerDay.length=0,this.props.recoveredPerDay.length=0,this.redraw(),this.forceUpdate()}},{key:"render",value:function(){var e=this;this.redraw();var t=Math.round(this.props.infectedPerDay[this.props.infectedPerDay.length-1]/this.props.population*100),a=Math.round(this.props.recoveredPerDay[this.props.recoveredPerDay.length-1]/this.props.population*100),n=Math.round(this.props.deadPerDay[this.props.deadPerDay.length-1]/this.props.population*100);isNaN(t)&&(t=0),isNaN(a)&&(a=0),isNaN(n)&&(n=0);var r=i.a.createElement("span",null,i.a.createElement(N,{type:"infected"})," \xa0Infected: ",t,"%"),s=i.a.createElement("span",null,i.a.createElement(N,{type:"removed"})," \xa0Recovered: ",a,"%"),l=null;this.props.showDeaths&&(l=i.a.createElement("span",null,i.a.createElement(N,{type:"dead"})," ",i.a.createElement("span",{style:{backgroundColor:"#FFA"}},"\xa0Dead: ",n,"%\xa0")));var o=this.width;return null===o&&(o=300),i.a.createElement("div",null,i.a.createElement("div",{className:"plot-container"},i.a.createElement("div",{className:"plot-xaxis"},"time \u27f6"),i.a.createElement("div",{className:"plot-chart"},i.a.createElement("canvas",{ref:this.canvasRef,width:o,height:this.height})),i.a.createElement("div",{className:"plot-legend"},i.a.createElement("div",{className:"plot-legend-button"},i.a.createElement(R,{onClick:function(){e.resetArrays()}},"Clear")),i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},i.a.createElement("div",null,r),i.a.createElement("div",null,s),i.a.createElement("div",null,l)))))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).canvasRef=i.a.createRef(),a.previousSimulationParams=["foo"],a.previousDrawingParams=[],a.previousInteractionsParams=[],a.onTick=a.onTick.bind(Object(d.a)(Object(d.a)(a))),a.onEnter=a.onEnter.bind(Object(d.a)(Object(d.a)(a))),a.onLeave=a.onLeave.bind(Object(d.a)(Object(d.a)(a))),a.initializeFromProps(a.props,!0),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(d.a)(Object(d.a)(a))),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"updateWindowDimensions",value:function(){var e=this.props.gridCols*this.props.nodeSize;this.props.nodeSize>=5&&(e+=this.props.gridCols);var t=Math.min(e,document.documentElement.clientWidth-40),a=Math.floor(t/this.props.gridCols);t=a*this.props.gridCols,this.gridWidth===t&&this.nodeSize===a||(this.gridWidth=t,this.nodeSize=a,this.redraw(!0))}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"initializeFromProps",value:function(e,t){this.gridWidth=e.gridCols*e.nodeSize,this.nodeSize=e.nodeSize;var a=e.randomSeed;-1===a&&(a=Math.floor(3e6*Math.random())),this.rng=new E(a);var n={numActiveNodes:0,playing:!1,visible:!1,daysIncubating:e.daysIncubating,daysSymptomatic:e.daysSymptomatic,deathRate:e.deathRate,decreaseInEncountersAfterSymptoms:e.decreaseInEncountersAfterSymptoms,chanceOfIsolationAfterSymptoms:e.chanceOfIsolationAfterSymptoms,hospitalCapacityPct:e.hospitalCapacityPct,immunityFraction:e.immunityFraction,longDistaceNetworkActive:e.addLinkedNodes,maxIterations:e.maxIterations,personHours:e.personHours,transmissionProbability:e.transmissionProbability,travelRadius:e.travelRadius,centerNodeNeighborsToDisplay:[],drawNodeOutlines:e.drawNodeOutlines,hospitalCapacitySliderHighlighted:!1,speed:e.speed,capacityPerDay:[],deadPerDay:[],infectedPerDay:[],recoveredPerDay:[]};t?this.state=n:this.setState(n)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw(!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"onTick",value:function(){this.state.playing&&this.state.visible&&(this.simulateStep(),this.redraw(!0))}},{key:"onEnter",value:function(){this.setState({visible:!0}),this.redraw(!0)}},{key:"onLeave",value:function(){this.setState({visible:!1})}},{key:"regenerate",value:function(){this.generate(),this.forceUpdate()}},{key:"resetPlotVariables",value:function(){this.state.capacityPerDay=[],this.state.deadPerDay=[],this.state.infectedPerDay=[],this.state.recoveredPerDay=[]}},{key:"generate",value:function(e){var t=[];if(e||!y.arraysEqual(this.previousSimulationParams,t)){this.previousSimulationParams=t,this.state.infectedPerDay.length>1&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-2]&&(this.state.capacityPerDay.push(null),this.state.deadPerDay.push(null),this.state.infectedPerDay.push(null),this.state.recoveredPerDay.push(null)),0!==this.state.infectedPerDay.length&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-1]||(this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(0),this.state.infectedPerDay.push(this.props.nug),this.state.recoveredPerDay.push(0)),this.state.centerNodeNeighborsToDisplay=[];var a=this.props.gridRows,n=this.props.gridCols;this.grid=[];for(var i=0;i<a;i++){for(var r=[],s=0;s<n;s++){var l=new S(this.rng,i,s);l.immune=this.rng.random()<this.state.immunityFraction,r.push(l)}this.grid.push(r)}var o=new Set;if(this.props.addLinkedNodes)for(var c=0;c<3;c++)for(var h=0;h<3;h++){var u=Math.floor(a/6*(2*c+1)),d=Math.floor(n/6*(2*h+1)),m=this.grid[u][d];m.linked=!0,m.setSusceptible(),o.add(m)}if(this.props.addCities){var p=[];p.push([Math.floor(.75*a),Math.floor(.25*n)]),p.push([Math.floor(.25*a),Math.floor(.75*n)]);for(var v=0;v<a;v++)for(var f=0;f<n;f++)for(var g=0;g<p.length;g++){var E=p[g],w=E[0],b=E[1],k=Math.sqrt(Math.pow(w-v,2)+Math.pow(b-f,2));k<=16&&(this.grid[v][f].specialDegree=8-Math.floor(k/4))}}var D=Math.floor((a-1)/2),P=Math.floor((n-1)/2);if(1===this.props.nug)0===this.state.daysIncubating?this.grid[D][P].setInfected():this.grid[D][P].setExposed();else if(5===this.props.nug)for(var I=-1;I<=1;I++)for(var C=-1;C<=1;C++)1===Math.abs(I)&&1===Math.abs(C)||this.grid[D+I][P+C].setExposed();else if(20===this.props.nug)for(var O=-2;O<=2;O++)for(var R=-2;R<=2;R++)2===Math.abs(O)&&2===Math.abs(R)||this.grid[D+O][P+R].setExposed();this.redraw(!0),this.setState({numActiveNodes:this.props.nug})}}},{key:"simulateStep",value:function(){for(var e=this.props.gridRows,t=this.props.gridCols,a=new Set,n=0;n<e;n++)for(var i=0;i<t;i++){var r=this.grid[n][i];r.startDay(),this.state.longDistaceNetworkActive&&r.linked&&a.add(r)}for(var s=[],l=0;l<e;l++)for(var o=0;o<t;o++){var c=this.grid[l][o];this.props.showInteractions&&this.isCenterNode(l,o)&&c.canInfectOthers()?s=this.maybeInfect(c,l,o,a):this.maybeInfect(c,l,o,a)}for(var h=0,u=0;u<e;u++)for(var d=0;d<t;d++){var m=this.grid[u][d];m.getNextState()!==b.EXPOSED&&m.getNextState()!==b.INFECTED||h++}var p=this.state.chanceOfIsolationAfterSymptoms;this.props.showChanceOfIsolationAfterSymptomsSlider||(p=0);for(var v=this.state.hospitalCapacityPct>-1&&h>this.state.hospitalCapacityPct*(e*t),y=0;y<e;y++)for(var f=0;f<t;f++){this.grid[y][f].endDay(v,this.state.daysIncubating,this.state.daysSymptomatic,this.props.showDeaths,this.state.deathRate,p)}for(var g=0,E=0,w=0;w<e;w++)for(var S=0;S<t;S++){var k=this.grid[w][S];k.getNextState()===b.REMOVED?E++:k.getNextState()===b.DEAD&&g++}this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(g),this.state.infectedPerDay.push(h),this.state.recoveredPerDay.push(E),this.state.centerNodeNeighborsToDisplay=s,this.setState({numActiveNodes:h,playing:this.state.playing&&0!==h}),this.redraw(!0)}},{key:"isCenterNode",value:function(e,t){return e===t&&e===Math.floor(this.props.gridRows/2)}},{key:"maybeInfect",value:function(e,t,a,n){var i=[];if((e.canInfectOthers()||this.isCenterNode(t,a))&&(i=this.getNeighbors(e,t,a,n)),e.canInfectOthers()){var r=this.state.transmissionProbability;r=Math.pow(r,3);var s=!0,l=!1,o=void 0;try{for(var c,h=i[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var u=c.value;e.tryToInfect(u,r)}}catch(d){l=!0,o=d}finally{try{s||null==h.return||h.return()}finally{if(l)throw o}}}return i}},{key:"chooseRandomNeighbor",value:function(e,t,a){for(var n=this.state.travelRadius,i=null;null===i;){var r=this.rng.randIntBetween(-n,n),s=this.rng.randIntBetween(-n,n);if((0!==r||0!==s)&&(1!==n||1!==Math.abs(r)||1!==Math.abs(s))){var l=t+r,o=a+s;l<0||l>=this.grid.length||o<0||o>=this.grid[0].length||(i=this.grid[l][o])}}return i}},{key:"getNeighbors",value:function(e,t,a,n){var i=[],r=this.state.personHours;if(e.isIsolating()&&(r*=1-this.state.decreaseInEncountersAfterSymptoms),0===this.state.travelRadius);else if(1===this.state.travelRadius&&4===r)t>0&&i.push(this.grid[t-1][a]),a>0&&i.push(this.grid[t][a-1]),t<this.grid.length-1&&i.push(this.grid[t+1][a]),a<this.grid[0].length-1&&i.push(this.grid[t][a+1]);else for(;i.length<r;){var s=this.chooseRandomNeighbor(e,t,a);i.push(s)}return i}},{key:"togglePlayback",value:function(){0===this.state.numActiveNodes&&this.generate(!0),this.setState({playing:!this.state.playing})}},{key:"inInitialPosition",value:function(){return 0===this.state.infectedPerDay.length}},{key:"redraw",value:function(e){if(null!==this.canvas&&void 0!==this.canvas){var t=[this.state.drawNodeOutlines,this.state.longDistaceNetworkActive,this.state.personHours,this.state.travelRadius];if(e||!y.arraysEqual(this.previousDrawingParams,t)){this.previousDrawingParams=t;var a=[this.state.personHours,this.state.travelRadius],n=!y.arraysEqual(this.previousInteractionsParams,a);this.previousInteractionsParams=a;var i=this.canvas.getContext("2d");i.fillStyle="#FFF",i.fillRect(0,0,this.gridWidth,this.gridWidth);for(var r=0;r<this.grid.length;r++)for(var s=0;s<this.grid[r].length;s++){var l=this.grid[r][s];this.drawCell(r,s,l,i,!1)}if(this.props.showInteractions&&(n||this.inInitialPosition())){var o=Math.floor(this.props.gridRows/2),c=o,h=this.grid[o][c],u=this.getNeighbors(h,o,c,null),d=!0,m=!1,p=void 0;try{for(var v,f=u[Symbol.iterator]();!(d=(v=f.next()).done);d=!0){var g=v.value;this.drawCell(g.r,g.c,g,i,!0)}}catch(P){m=!0,p=P}finally{try{d||null==f.return||f.return()}finally{if(m)throw p}}var E=!0,w=!1,b=void 0;try{for(var S,k=u[Symbol.iterator]();!(E=(S=k.next()).done);E=!0){var D=S.value;this.drawInteraction(o,c,D.r,D.c,i)}}catch(P){w=!0,b=P}finally{try{E||null==k.return||k.return()}finally{if(w)throw b}}}}}else console.log("no canvas")}},{key:"drawInteraction",value:function(e,t,a,n,i){var r=this.nodeSize;i.strokeStyle="#000",i.beginPath(),i.moveTo((t+.5)*r,(e+.5)*r),i.lineTo((n+.5)*r,(a+.5)*r),i.stroke()}},{key:"drawCell",value:function(e,a,n,i,r){var s=this.nodeSize,l=e*s,o=a*s;if(n.isExposed())i.fillStyle=b.EXPOSED_COLOR;else if(n.isInfected())n.isIsolating()?i.fillStyle=b.ISOLATING_COLOR:i.fillStyle=b.INFECTED_COLOR;else if(n.isRemoved())i.fillStyle=b.REMOVED_COLOR;else if(n.isDead())i.fillStyle=b.DEAD_COLOR;else if(i.fillStyle=b.SUSCEPTIBLE_COLOR,null!==n.specialDegree){y.assert(n.specialDegree>=4&&n.specialDegree<=8,"node.specialDegree should be between 4 and 8; was: "+n.specialDegree);var c=(n.specialDegree-4)/4;i.fillStyle=v.hex(v.blend(v.makeHex(t.SUSCEPTIBLE_COLOR),v.makeHex("#BBB"),c))}var h=1;if((this.nodeSize<5||this.nodeSize<this.props.nodeSize)&&(h=0),i.fillRect(o,l,s-h,s-h),r||n.linked&&this.state.longDistaceNetworkActive){i.lineWidth=1,i.strokeStyle="#000";var u=o-.5,d=s-h+1;0===o&&(u=.5,d-=1);var m=l-.5,p=s-h+1;0===l&&(m=.5,p-=1),i.strokeRect(u,m,d,p)}}},{key:"renderSlider",value:function(e,a,n,r,s,l,o,c){var h;h=0===o?"":o?i.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",t.renderPercentage(a)):i.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",i.a.createElement("strong",null,Math.round(100*a)/100));var u="";return c&&(u=" highlighted"),i.a.createElement("div",{className:"slider-container"+u},i.a.createElement("div",{className:"slider-name"},e,h),i.a.createElement("div",{className:"slider-slider"},i.a.createElement(g.a,{classes:{container:"slider-slider-container",thumbIconWrapper:""},min:r,max:s,step:l,value:a,onChange:n})))}},{key:"render",value:function(){var e=this;this.generate(),this.redraw();var t=this.props.showAllControls,a=null;(t||this.props.showTransmissionProbabilitySlider)&&(a=this.renderSlider("Transmission rate",this.state.transmissionProbability,function(t,a){e.setState({transmissionProbability:a})},0,this.props.maxTransmissionRate,.01,!1,"transmissionRate"===this.props.highlight));var n=null,r=null;(t||this.props.showHospitalCapacitySlider)&&(r=this.renderSlider("Hospital capacity",this.state.hospitalCapacityPct,function(t,a){e.setState({hospitalCapacityPct:a})},0,1,.01,!0,!1));var s=null;(t||this.props.showTravelRadiusSlider)&&(s=this.renderSlider("Travel radius",this.state.travelRadius,function(t,a){e.setState({travelRadius:a})},0,Math.min(30,Math.floor(this.props.gridRows/2)),1,!1,!1));var l=null;(t||this.props.showPersonHoursSlider)&&(l=this.renderSlider("Encounters per day",this.state.personHours,function(t,a){e.setState({personHours:a})},1,30,1,!1,!1));var o=null;(t||this.props.showDaysPerStateControls)&&(o=this.renderSlider("Days in incubation",this.state.daysIncubating,function(t,a){e.setState({daysIncubating:a})},0,20,1,!1,!1));var c=null;(t||this.props.showDaysPerStateControls)&&(c=this.renderSlider("Days with symptoms",this.state.daysSymptomatic,function(t,a){e.setState({daysSymptomatic:a})},1,20,1,!1,!1));var h=null;(t||this.props.showChanceOfIsolationAfterSymptomsSlider)&&(h=this.renderSlider("Self-quarantine rate",this.state.chanceOfIsolationAfterSymptoms,function(t,a){e.setState({chanceOfIsolationAfterSymptoms:a})},0,1,.01,!0,!1));var u=null;(t||this.props.showDecreaseInEncountersAfterSymptomsSlider)&&(u=this.renderSlider("Self-quarantine strictness",this.state.decreaseInEncountersAfterSymptoms,function(t,a){e.setState({decreaseInEncountersAfterSymptoms:a})},0,1,.01,!0,!1));var d=null;if(t||this.props.showDeathRateSlider){var m="Fatality rate";this.state.hospitalCapacityPct>-1&&(m="Input fatality rate"),d=this.renderSlider(m,this.state.deathRate,function(t,a){e.setState({deathRate:a})},0,.3,.01,!0,!1)}var p=null;if(t||this.props.showPlaybackControls){var v=i.a.createElement(R,{onClick:function(){e.setState({playing:!1}),e.generate(!0),e.forceUpdate()}},"Reset"),y=i.a.createElement("span",{style:{fontSize:"10pt"}},"\u25b7");this.state.playing&&(y=i.a.createElement("span",null,i.a.createElement("b",null,"||")));var f=i.a.createElement(R,{highlighted:!this.state.playing,onClick:function(){e.togglePlayback()}},y),g=i.a.createElement(R,{onClick:function(){e.simulateStep(),e.setState({playing:!1})}},"Step");p=i.a.createElement("div",{className:"playback-controls-container"},v,f,g)}var E=null;if(this.props.addLinkedNodes){var b="Long distance: disabled";this.state.longDistaceNetworkActive&&(b="Long distance: enabled"),E=i.a.createElement("div",null,i.a.createElement("span",{onClick:function(){e.setState({longDistaceNetworkActive:!e.state.longDistaceNetworkActive})}},b))}var S=null;this.props.showProTip&&(S=i.a.createElement("div",{style:{color:"#666",fontSize:"12pt",marginTop:"1em"}},"\ud83d\udc46 Pro-tip: You can adjust sliders while the simulation is running."));var D=1e3*(1-Math.pow(this.state.speed,.2));D=Math.max(D,16);var P=null;"transmissionRate"===this.props.highlight?(P=a,a=null):"immunity"===this.props.highlight&&(P=n,n=null);var I=null;if(this.props.showAliveFraction){var C=this.props.gridRows*this.props.gridRows;I=i.a.createElement(x,{hospitalCapacity:this.state.hospitalCapacityPct*C,capacityPerDay:this.state.capacityPerDay,deadPerDay:this.state.deadPerDay,infectedPerDay:this.state.infectedPerDay,population:C,recoveredPerDay:this.state.recoveredPerDay,showDeaths:this.props.showDeaths})}return i.a.createElement("div",{className:"widget-container",style:{display:"flex",flexDirection:"column",alignItems:"center"}},i.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.a.createElement(k.a,{onEnter:this.onEnter,onLeave:this.onLeave,scrollableAncestor:window},i.a.createElement("canvas",{ref:this.canvasRef,width:this.gridWidth,height:this.gridWidth})),null),p,i.a.createElement("div",{style:{height:"0.5em"}}),P,r,d,h,u,l,s,a,n,o,c,E,S,I,i.a.createElement(w,{milliseconds:D,callback:this.onTick}))}}],[{key:"shuffleInPlace",value:function(e,t){for(var a=e.length-1;a>0;a--){var n=Math.floor(t.random()*(a+1)),i=[e[n],e[a]];e[a]=i[0],e[n]=i[1]}return e}},{key:"renderPercentage",value:function(e){var t=Math.round(100*e);return i.a.createElement("span",null,i.a.createElement("strong",null,t),"%")}}]),t}(n.Component);A.NEIGHBOR_CLASSES=[[[0,0]],[[-1,0],[1,0],[0,-1],[0,1]],[[-1,-1],[-1,1],[1,-1],[1,1]],[[-2,-2],[-2,-1],[-2,0],[-2,1],[-2,2],[-1,2],[0,2],[1,2],[2,2],[2,1],[2,0],[2,-1],[2,-2],[1,-2],[0,-2],[-1,-2]]],A.defaultProps={randomSeed:-1,addCities:!1,addLinkedNodes:!1,gridCols:1,gridRows:1,daysIncubating:7,daysSymptomatic:8,deathRate:.03,decreaseInEncountersAfterSymptoms:.25,chanceOfIsolationAfterSymptoms:.25,hospitalCapacityPct:-1,immunityFraction:0,maxIterations:-1,nug:20,personHours:10,transmissionProbability:.4,travelRadius:5,drawNodeOutlines:!0,speed:.5,immunitySliderName:"Immunity",maxTransmissionRate:1,showAliveFraction:!1,showAllControls:!1,showDaysPerStateControls:!1,showDeaths:!1,showDecreaseInEncountersAfterSymptomsSlider:!1,showChanceOfIsolationAfterSymptomsSlider:!1,showDeathRateSlider:!1,showDegreeSlider:!1,showHospitalCapacitySlider:!1,showImmunityFractionSlider:!1,showInteractions:!0,showPersonHoursSlider:!1,showPlaybackControls:!0,showProTip:!1,showSimulationButtons:!1,showSpeedControls:!1,showTransmissionProbabilitySlider:!1,showTravelRadiusSlider:!1};var T=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=null;null!==this.props.title&&void 0!==this.props.title&&(e=i.a.createElement("div",{className:"figure-title"},this.props.title));var t=null;null!==this.props.caption&&void 0!==this.props.caption&&(t=i.a.createElement("div",{className:"figure-caption"},this.props.caption));var a="figure-body";return this.props.image&&(a="figure-body image"),i.a.createElement("div",{className:"figure-container"},e,i.a.createElement("div",{className:a},this.props.children),t)}}]),t}(n.Component),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={spoilersVisible:!1},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"renderMainPost",value:function(){var e,t,a=this;e=this.state.spoilersVisible?"spoiler-revealed":"spoiler",t=i.a.createElement("label",null,i.a.createElement("span",{style:{cursor:"pointer"}},i.a.createElement("input",{type:"checkbox",value:this.state.spoilersVisible,onChange:function(e){a.setState({spoilersVisible:e.target.checked})}})," Show spoilers"));var n=i.a.createElement("code",{className:"code-exposed"},"you"),r=i.a.createElement("code",{className:"code-susceptible"},"Susceptible"),s=i.a.createElement("code",{className:"code-infectious"},"Infected"),l=i.a.createElement("code",{className:"code-removed"},"Recovered"),o=i.a.createElement("code",{className:"code-dead"},"Dead"),c=i.a.createElement("code",{className:"code-quarantined"},"Self-quarantined");return i.a.createElement("div",{className:"post-content"},i.a.createElement("div",null,i.a.createElement("h1",null,"\u0412\u0441\u043f\u044b\u0448\u043a\u0430"),i.a.createElement("h5",{className:"author"},"by Kevin Simler",i.a.createElement("br",null),"March 16, 2020")),i.a.createElement("div",null,i.a.createElement("span",{className:"deemphasized"},i.a.createElement("a",{href:"https://www.podemosaprender.org/brote/"},"en Espa\xf1ol"))),i.a.createElement("div",null,i.a.createElement("a",{href:"https://twitter.com/Harry_Stevens"},"Harry Stevens")," at The Washington Post recently published a ",i.a.createElement("em",null,"very")," elegant simulation of how a disease like COVID-19 spreads. If you haven't already, I highly recommend ",i.a.createElement("a",{href:"https://www.washingtonpost.com/graphics/2020/world/corona-simulator/"},"checking it out"),"."),i.a.createElement("div",null,"Today I want to follow up with something I've been working on: ",i.a.createElement("strong",null,"playable simulations"),' of a disease outbreak. "Playable" means you\'ll get to tweak parameters (like transmission and mortality rates) and watch how the epidemic unfolds.'),i.a.createElement("div",null,"By the end of this article, I hope you'll have a better understanding \u2014 perhaps better ",i.a.createElement("em",null,"intuition")," \u2014 for what it takes to contain this thing. But first!..."),i.a.createElement("div",null,i.a.createElement("span",{style:{backgroundColor:"#FFC"}},i.a.createElement("strong",null,"AN IMPORTANT WARNING")),":"),i.a.createElement("div",null,i.a.createElement("strong",null,"This is ",i.a.createElement("em",null,"not")," an attempt to model COVID-19.")),i.a.createElement("div",null,"What follows is a ",i.a.createElement("em",null,"simplified")," model of a disease process. The goal is to learn how epidemics unfold ",i.a.createElement("em",null,"in general"),"."),i.a.createElement("div",null,i.a.createElement("span",null,"WARNING #2"),": I'm not an epidemiologist! I defer to infectious disease experts (and so should you). I have almost certainly made mistakes in this article, but I'll correct them as quickly as I can. If you see any problems, please ",i.a.createElement("a",{href:"https://meltingasphalt.com/contact/"},"get in touch"),"."),i.a.createElement("div",null,"Alright?"),i.a.createElement("div",null,"Let's do this."),i.a.createElement("div",null,i.a.createElement("h3",null,"A grid of people")),i.a.createElement("div",null,"We're going to build our model up slowly, one piece at a time."),i.a.createElement("div",null,"The first thing a disease needs is a ",i.a.createElement("strong",null,"population"),", i.e., the set of people who can potentially catch the disease. Ours will live in neat rows and columns, like the 9x9 grid you see here:"),i.a.createElement(T,null,i.a.createElement(A,{daysIncubating:0,daysSymptomatic:1,gridRows:9,gridCols:9,nodeSize:30,nug:1,randomSeed:100,personHours:4,showPlaybackControls:!1,speed:.4,transmissionProbability:1,travelRadius:1})),i.a.createElement("div",null,"Each square represents a single person. The poor soul at the center, as you may have guessed, is ",s,". Meanwhile, everyone else is ",r,"."),i.a.createElement("div",null,i.a.createElement("h3",null,"Time")),i.a.createElement("div",null,"Now let's incorporate time into our model."),i.a.createElement("div",null,'The "Step" button (below) moves the simulation forward 1 day per click. Or you can press the \u25b7 button to watch things happen on their own:'),i.a.createElement(T,null,i.a.createElement(A,{daysIncubating:0,daysSymptomatic:1e10,gridRows:9,gridCols:9,nodeSize:30,nug:1,randomSeed:100,personHours:4,showInteractions:!1,speed:.4,transmissionProbability:1,travelRadius:1})),i.a.createElement("div",null,"Oh no. It looks like everyone sneezed on their immediate neighbors \u2014 north, east, south, west \u2014 and the whole world got sick."),i.a.createElement("div",null,i.a.createElement("h3",null,"Recovery")),i.a.createElement("div",null,"But people don't stay sick forever. Let's see what happens when they get better after 2 steps (i.e., 2 days):"),i.a.createElement(T,null,i.a.createElement(A,{daysIncubating:0,daysSymptomatic:2,gridRows:9,gridCols:9,nodeSize:30,nug:1,randomSeed:100,personHours:4,showInteractions:!1,speed:.4,transmissionProbability:1,travelRadius:1})),i.a.createElement("div",null,"Great, now people can transition from ",s," to ",l,"."),i.a.createElement("div",null,"Here's a handy legend:"),i.a.createElement("div",null,i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(N,{type:"susceptible"})," \xa0",i.a.createElement("b",null,"Susceptible")),i.a.createElement("li",null,i.a.createElement(N,{type:"infected"})," \xa0",i.a.createElement("b",null,"Infected")),i.a.createElement("li",null,i.a.createElement(N,{type:"removed"})," \xa0",i.a.createElement("b",null,"Recovered")))),i.a.createElement("div",null,"For purposes of our simulation, once someone is ",l,", they can't get reinfected. This is hopefully (and probably) true for COVID-19, but not certain."),i.a.createElement("div",null,i.a.createElement("h3",null,"Incubation period")),i.a.createElement("div",null,"In discussions of COVID-19, you may have heard that the disease has a long ",i.a.createElement("strong",null,"incubation period"),". This is the time between when a person initially contracts the disease and the onset of first symptoms."),i.a.createElement("div",null,"With COVID-19, it seems that patients are contagious during the incubation period. They may not even realize they're sick, but they're still able to infect others."),i.a.createElement("div",null,"We will replicate this feature in our disease model. (But remember, we're not trying to model COVID-19 precisely!)"),i.a.createElement("div",null,"Here's what an incubation period looks like:"),i.a.createElement(T,null,i.a.createElement(A,{gridRows:25,gridCols:25,nodeSize:20,nug:1,randomSeed:100,personHours:4,showDaysPerStateControls:!0,showInteractions:!1,speed:.4,transmissionProbability:1,travelRadius:1})),i.a.createElement("div",null,"The way I've chosen to model this disease, there's no important distinction between the pink and red states. As far as the virus is concerned, both states behave the same."),i.a.createElement("div",null,"Nevertheless, I wanted to include the incubation period as a (visual) reminder that carriers of COVID-19 are lurking among us, hidden from the official statistics, totally unaware that they're infected."),i.a.createElement("div",null,"... unaware that they're spreading the disease to others."),i.a.createElement("div",null,"Even as you read this, ",n," may be such a person."),i.a.createElement("div",null,i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(N,{type:"susceptible"})," \xa0",i.a.createElement("b",null,"Susceptible")),i.a.createElement("li",null,i.a.createElement(N,{type:"exposed"})," \xa0",i.a.createElement("b",null,"Infected (incubation period, no symptoms)")),i.a.createElement("li",null,i.a.createElement(N,{type:"infected"})," \xa0",i.a.createElement("b",null,"Infected (with symptoms)")),i.a.createElement("li",null,i.a.createElement(N,{type:"removed"})," \xa0",i.a.createElement("b",null,"Recovered")))),i.a.createElement("div",null,i.a.createElement("h3",null,"Probabilistic infection")),i.a.createElement("div",null,"OK, enough."),i.a.createElement("div",null,"Real diseases don't spread outward with 100 percent certainty. They spread probabilistically."),i.a.createElement("div",null,"So let's introduce a new parameter: the ",i.a.createElement("strong",null,"transmission rate"),". This controls the chance that an infection gets passed from person to person."),i.a.createElement("div",null,"Can you find a value for the transmission rate that keeps the disease from spreading to the entire population?"),i.a.createElement(T,null,i.a.createElement(A,{gridRows:51,gridCols:51,maxTransmissionRate:1,nodeSize:10,nug:5,randomSeed:99,personHours:4,showDaysPerStateControls:!0,showInteractions:!1,showProTip:!0,showTransmissionProbabilitySlider:!0,speed:.9,transmissionProbability:.5,travelRadius:1})),i.a.createElement("div",null,"Q: What's the ",i.a.createElement("em",null,"largest")," transmission rate where the disease doesn't seem capable of spreading forever (e.g., reaching all four edges of the grid)?"),i.a.createElement("div",{style:{marginLeft:"2em"}},t),i.a.createElement("div",null,"In my experiments, it seems to be around ",i.a.createElement("span",{className:e},"0.35"),", maybe ",i.a.createElement("span",{className:e},"0.34"),". Below that, I've seen the infection fizzle out every time. Above, it generally infects most of the grid."),i.a.createElement("div",null,"Here's how transmission works in our disease model."),i.a.createElement("div",null,"Every day, each person has a fixed number of ",i.a.createElement("strong",null,"encounters")," with the people nearby."),i.a.createElement("div",null,"Thus far, we've allowed people to interact only with their immediate neighbors, for a total of 4 encounters per day. We'll vary these assumptions below."),i.a.createElement("div",null,"During each encounter, the transmission rate determines the probability that an ",s," person will give the disease to a ",r," person. The higher the transmission rate, the more likely the disease gets passed along."),i.a.createElement("div",null,"In reality, there are many different types of encounters. You might brush past someone on the sidewalk. Or sit next to them on a bus. Perhaps you'll share an ice cream cone. Each of these encounters would result in a different probability of transmitting the infection. But in our model, for simplicity, all encounters share the same transmission rate."),i.a.createElement("div",null,"\u2014\u2014"),i.a.createElement("div",null,"As you continue playing with these simulations (above and below) and thinking about their relevance to coronavirus/COVID-19, here's something to keep in mind:"),i.a.createElement("div",null,"Transmission rate is partly a function of the ",i.a.createElement("em",null,"disease itself")," (how naturally infectious it is), but also a function of the ",i.a.createElement("em",null,"environment")," that the disease lives in. This includes both the physical environment (e.g., air temperature and humidity) as well as the social environment (e.g., people's behaviors)."),i.a.createElement("div",null,"For example, when people wash their hands and wear masks to contain coughs, the transmission rate per encounter goes down \u2014 even if the virus itself doesn't change."),i.a.createElement("div",null,'Now, for any viral-growth process, it\'s possible to find a transmission rate low enough to completely stop the spread. This is called the "critical threshold," and you can learn more about it ',i.a.createElement("a",{href:"https://meltingasphalt.com/interactive/going-critical"},"here"),"."),i.a.createElement("div",null,"But COVID-19 is so infectious, it's hard to get below the critical transmission rate. We can only wash our hands so many times a day. Even wearing masks out in public won't be enough enough to bring transmission down far enough (though every inch is helpful)."),i.a.createElement("div",null,"We ",i.a.createElement("em",null,"could")," all wear hazmat suits every time we leave the house; technically that would solve the transmission problem (without changing our patterns of social interaction). But since that's, uh, impractical, let's consider other ways to keep this disease from consuming us."),i.a.createElement("div",null,i.a.createElement("h3",null,"Travel")),i.a.createElement("div",null,"Here's another unrealistic assumption we've been making: we've been allowing people to interact only with their immediate neighbors."),i.a.createElement("div",null,"What happens when we let people travel farther afield? (We're still assuming 4 encounters per day, a parameter we'll expose in the next section.)"),i.a.createElement("div",null,"As you pull the ",i.a.createElement("strong",null,"travel radius")," slider below, you'll see a sample of the encounters that the center person will have on any given day. (We can't draw ",i.a.createElement("em",null,"everyone's")," encounters because it would get too crowded. You'll just have to use your imagination.) Note that in our model, unlike in real life, each day brings a new (random) set of encounters."),i.a.createElement(T,null,i.a.createElement(A,{degree:24,gridRows:51,gridCols:51,maxTransmissionRate:1,nodeSize:10,nug:5,personHours:4,randomSeed:99,showAliveFraction:!0,showInteractions:!0,showTravelRadiusSlider:!0,speed:.8,travelRadius:15})),i.a.createElement("div",null,"Note that if you restrict travel from the beginning (e.g., to a radius of 2 units), you can slow the infection down a great deal."),i.a.createElement("div",null,"But what happens when you start with unrestricted travel, let the infection spread pretty much everywhere, and only restrict travel ",i.a.createElement("em",null,"later"),"?"),i.a.createElement("div",null,"In other words, how early in the infection curve do you have to curtail travel in order for it to meaningful slow the outbreak?"),i.a.createElement("div",null,"Go ahead, try it. Start with a travel radius of 25. Then play the simulation, pausing when you get to about 10 percent infected. Then reduce the travel radius to 2 and play it out. What happens?"),i.a.createElement("div",null,"Takeaway: travel restrictions are most useful when they're applied early, at least for the purpose of flattening the curve. (So let's get them in place!)"),i.a.createElement("div",null,"But travel restrictions can help even in the later stages of an outbreak, for at least two reasons:"),i.a.createElement("div",null,i.a.createElement("ol",null,i.a.createElement("li",null,"Buses, trains, and airports are places where people gather together in cramped quarters. When people stop using these modes of transport, they reduce the number of encounters they have with potentially infected people. (We'll explore this more below.)"),i.a.createElement("li",null,"Reducing travel is critical ",i.a.createElement("em",null,"in concert with regional containment measures"),". If one region gets the outbreak under control, but neighboring regions are still on fire, you have to protect the controlled region. (We're not going to explore containment measures in this article, but they may be important soon, and if you're interested, you might start ",i.a.createElement("a",{href:"https://necsi.edu/beyond-contact-tracing"},"here"),".)"))),i.a.createElement("div",null,i.a.createElement("h3",null,"Number of encounters")),i.a.createElement("div",null,"Alright, let's really open this thing up."),i.a.createElement("div",null,"In the simulation below, you can vary the ",i.a.createElement("strong",null,"encounters per day"),"."),i.a.createElement("div",null,"Let's start at 20. What's the minimum value we need to keep the outbreak contained?"),i.a.createElement(T,null,i.a.createElement(A,{degree:24,gridRows:51,gridCols:51,personHours:20,nodeSize:10,nug:5,randomSeed:100,showAliveFraction:!0,showInteractions:!0,showPersonHoursSlider:!0,showTransmissionProbabilitySlider:!0,showTravelRadiusSlider:!0,speed:.8,transmissionProbability:.3,travelRadius:10})),i.a.createElement("div",null,"As you can see, reducing encounters per day has a ",i.a.createElement("em",null,"dramatic effect")," on the outbreak. It easily flattens the curve, and even has the potential (when taken very seriously) to completely quench an outbreak."),i.a.createElement("div",null,'This is the effect we\'re hoping for when we call for "social distance." This is why so many people are pleading with their officials to stop the parades and close the schools, and why all of us should stay away from bars and coffee shops and restaurants, and work from home as much as possible.'),i.a.createElement("div",null,"The NBA did their fans a tremendous service by canceling the rest of the season. Now we need to follow suit and ",i.a.createElement("em",null,"cancel everything"),"."),i.a.createElement("div",null,"In my understanding (again, not an expert), this is the single most important lever we have for fighting this thing."),i.a.createElement("div",null,i.a.createElement("h3",null,"Death")),i.a.createElement("div",null,"Not every patient recovers from a disease. Many end up ",o,"."),i.a.createElement("div",null,"Enter the ",i.a.createElement("strong",null,"fatality rate"),"."),i.a.createElement("div",null,"In our simulation, fatality rate is the probability that a patient who gets infected will ultimately die of the infection, assuming they get normal/adequate medical care."),i.a.createElement("div",null,i.a.createElement("span",{className:"deemphasized"},'(Update: an earlier version of this article made a distinction between case fatality rate and mortality rate, but failed to define the terms correctly. Collapsing this distinction and using the term "fatality rate" instead.)')),i.a.createElement("div",null,"The fatality rate for COVID-19 has been estimated between 1 percent and ",i.a.createElement("a",{href:"https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(20)30195-X/fulltext"},"6 percent"),". It might turn out to be lower than 1 percent, if there are a lot of undiagnosed cases. It's definitely higher when the medical system is overburdened (more on that in a minute)."),i.a.createElement("div",null,"We'll start at a 3 percent fatality rate for our disease model, but you can vary the parameter below:"),i.a.createElement(T,null,i.a.createElement(A,{gridRows:101,gridCols:101,nodeSize:5,nug:5,randomSeed:100,showAliveFraction:!0,showDeaths:!0,showDeathRateSlider:!0,showPersonHoursSlider:!0,showTransmissionProbabilitySlider:!0,showTravelRadiusSlider:!0,speed:1,transmissionProbability:.3})),i.a.createElement("div",null,"Those scattered black dots may not look like much. But remember, each is a human life lost to the disease."),i.a.createElement("div",null,i.a.createElement("h3",null,"Hospital capacity")),i.a.createElement("div",null,"Below you'll find one last new slider. It controls ",i.a.createElement("strong",null,"hospital capacity"),"."),i.a.createElement("div",null,"This is the number of patients (expressed as a percentage of the population) that can be treated by our medical system at any one time."),i.a.createElement("div",null,"Why does hospital capacity matter?"),i.a.createElement("div",null,"When there are more patients than the system can handle, they can\u2019t get the treatment they need. And as a result, they have significantly worse outcomes. As we've seen in Italy, some may be left to die in the hallways."),i.a.createElement("div",null,"I've heard people speak of hospital capacity as the \u201cnumber of beds,\u201d or \u201cnumber of ICU beds.\u201d My take is that mere \"beds\" can be set up in a gymnasium on very short notice. I think the real bottleneck is medical equipment \u2014 specifically ventilators. But I'm not sure. Maybe it\u2019s medical personnel."),i.a.createElement("div",null,"In reality, this matters ",i.a.createElement("em",null,"a lot"),". We need to identify what the bottleneck is, and do our best to alleviate pressure there. But for a simulation, we can just wave our hands and assume there's limited capacity somewhere in the system. Remember, we're not trying to model reality too carefully."),i.a.createElement("div",null,"In our disease model, here's how the medical system breaks:"),i.a.createElement("div",null,i.a.createElement("strong",null,"When there are more infections than hospital capacity, the fatality rate ",i.a.createElement("em",null,"doubles"),".")),i.a.createElement("div",null,"Give it a try. Pay special attention to the ",i.a.createElement("em",null,"input fatality rate")," (the value on the slider), which defines how often people die even in the best circumstances, vs. the ",i.a.createElement("em",null,"actual death rate")," (highlighted below the chart), which tells us how the system behaves under strain."),i.a.createElement(T,null,i.a.createElement(A,{gridRows:101,gridCols:101,hospitalCapacityPct:.05,nodeSize:5,nug:5,personHours:15,randomSeed:100,showAliveFraction:!0,showDeaths:!0,showDeathRateSlider:!0,showHospitalCapacitySlider:!0,speed:1,transmissionProbability:.28,travelRadius:15})),i.a.createElement("div",null,i.a.createElement("h3",null,'"Flatten the curve"')),i.a.createElement("div",null,"You've heard this before. You know why it's important. But now you're about to get a feel for it."),i.a.createElement("div",null,"This is your final test today."),i.a.createElement("div",null,"The input fatality rate is fixed at 3 percent. Hospital capacity is fixed at 5 percent."),i.a.createElement("div",null,"Play out the simulation and note the actual death rate: 6 percent. Then try to bring that number down."),i.a.createElement("div",null,"In other words, flatten the curve:"),i.a.createElement(T,null,i.a.createElement(A,{gridRows:101,gridCols:101,hospitalCapacityPct:.05,nodeSize:5,nug:5,personHours:15,randomSeed:100,showAliveFraction:!0,showDeaths:!0,showPersonHoursSlider:!0,showTransmissionProbabilitySlider:!0,showTravelRadiusSlider:!0,speed:1,transmissionProbability:.4,travelRadius:15})),i.a.createElement("div",null,"However this worked out for you in simulation, reality is going to be ",i.a.createElement("em",null,"so much harder"),". Real people don't respond like sliders in a UI."),i.a.createElement("div",null,"And here's the kicker: even if we manage to \"flatten the curve\" enough to meaningfully space out the case load, we're still positioned to lose millions and millions of lives."),i.a.createElement("div",null,"Maybe we won't lose as many as a worst-case scenario; maybe we won't lose them in hospital hallways. But as long as the virus continues to spread \u2014 which it shows every sign of doing \u2014 there's an unthinkable amount of suffering in our future."),i.a.createElement("div",null,"Unless we do the right things today."),i.a.createElement("div",null,"Stop traveling. Stop going out. Stop visiting your parents and your friends. Stop eating at restaurants. Pause everything you possibly can. If you're in charge of things, ",i.a.createElement("em",null,"cancel them"),". Lock. It. All. Down."),i.a.createElement("div",null,"Please: take decisive action now."),i.a.createElement("div",null,"COVID-19 is coming for us, and it won't be stopped by half-measures."),i.a.createElement("div",null,"\xa0"),i.a.createElement("div",null,"\xa0"),i.a.createElement("div",null,"\u2014\u2014"),i.a.createElement("div",null,"\xa0"),i.a.createElement("div",null,i.a.createElement("b",null,"License")),i.a.createElement("div",null,i.a.createElement("a",{href:"https://creativecommons.org/share-your-work/public-domain/cc0/"},"CC0")," \u2014 no rights reserved. You're free to use this work however you see fit, including copying it, modifying it, and distributing it on your own site."),i.a.createElement("div",null,i.a.createElement("a",{href:"https://github.com/kevinsimler/outbreak"},"Source code")),i.a.createElement("div",null,i.a.createElement("b",null,"Full model")),i.a.createElement("div",null,"The full model, with all sliders exposed, can be found at the very bottom of the page."),i.a.createElement("div",null,i.a.createElement("b",null,"Acknowledgments")),i.a.createElement("div",null,"I'd like to thank ",i.a.createElement("a",{href:"https://twitter.com/nsbarr"},"Nick Barr"),", ",i.a.createElement("a",{href:"https://twitter.com/origiful"},"Ian Padgham"),", ",i.a.createElement("a",{href:"https://twitter.com/frooblor"},"Diana Huang"),", Kellie Jack, ",i.a.createElement("a",{href:"https://twitter.com/btnaughton"},"Brian Naughton"),", ",i.a.createElement("a",{href:"https://twitter.com/yaneerbaryam"},"Yaneer Bar-Yam"),", and ",i.a.createElement("a",{href:"https://twitter.com/adamdangelo"},"Adam D'Angelo")," for helpful feedback and encouragement."),i.a.createElement("div",null,i.a.createElement("b",null,"Further reading")),i.a.createElement("div",null,i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("a",{href:"https://medium.com/@tomaspueyo/coronavirus-act-today-or-people-will-die-f4d3d9cd99ca"},"Coronavirus: Why You Must Act Now")," \u2014 Tomas Pueyo explains why we've been systematically underestimating this thing, and why that needs to change. Just read it."),i.a.createElement("li",null,i.a.createElement("a",{href:"https://medium.com/@joschabach/flattening-the-curve-is-a-deadly-delusion-eea324fe9727"},'Don\u2019t "Flatten the Curve," Stop It!'),' \u2014 Joscha Bach does some calculations on hospital capacity and concludes that "flattening the curve" won\'t be enough; we have to completely stop the outbreak.'),i.a.createElement("li",null,"The Washington Post's ",i.a.createElement("a",{href:"https://www.washingtonpost.com/graphics/2020/world/corona-simulator/"},"excellent simulation")," \u2014 brilliant use of billiard balls to show transmission and social distancing."),i.a.createElement("li",null,i.a.createElement("a",{href:"https://meltingasphalt.com/interactive/going-critical/"},"Going Critical")," \u2014 my previous exploration of diffusion and viral growth processes, including the nuclear reactions and the growth of knowledge."))),this.renderEndOfPostDivider(!0),i.a.createElement("div",{className:"subscription-footer"},i.a.createElement("a",{href:"https://meltingasphalt.com"},i.a.createElement("strong",null,"Melting Asphalt"))," is maintained by ",i.a.createElement("span",{className:"nohyphen"},"Kevin")," ",i.a.createElement("span",{className:"nohyphen"},"Simler"),".",i.a.createElement("br",null),i.a.createElement("br",null)," I publish ",i.a.createElement("em",null,"very infrequently"),", so you might want to get notified about new posts:",i.a.createElement("br",null),this.renderSubscribeForm(),i.a.createElement("br",null),"You can also ",i.a.createElement("a",{href:"https://twitter.com/KevinSimler"},i.a.createElement("strong",null,"find me on Twitter")),".",i.a.createElement("div",null,"\xa0")),i.a.createElement("div",null,"\xa0"),i.a.createElement("div",null,i.a.createElement("a",{name:"self-quarantine"}),i.a.createElement("h3",null,"Self-quarantine")),i.a.createElement("div",null,"(Thanks to ",i.a.createElement("a",{href:"https://twitter.com/jasonlegate"},"Jason Legate")," for suggesting and coding this addition to the disease model.)"),i.a.createElement("div",null,"In the simulation below, you can vary the ",i.a.createElement("strong",null,"self-quarantine rate"),", i.e., the chance that a patient will choose to isolate themselves once they become symptomatic. Patients who become ",c," will be drawn in blue instead of red."),i.a.createElement("div",null,"Additionally, you can vary how strict they are with the ",i.a.createElement("strong",null,"self-quarantine strictness")," parameters. At 100 percent strictness, patients who are isolating themselves have 0 encounters with other people. At 0 percent strictness, they have their normal number of encounters. And it varies linearly in between."),i.a.createElement("div",null,"Let's start the self-quarantine rate at 25 percent and the strictness also at 25 percent. What does it take to keep the outbreak contained?"),i.a.createElement(T,null,i.a.createElement(A,{degree:24,gridRows:51,gridCols:51,personHours:20,nodeSize:10,nug:5,randomSeed:100,showAliveFraction:!0,showInteractions:!0,showPersonHoursSlider:!0,showTransmissionProbabilitySlider:!0,showChanceOfIsolationAfterSymptomsSlider:!0,showDecreaseInEncountersAfterSymptomsSlider:!0,showTravelRadiusSlider:!0,speed:.8,transmissionProbability:.21,travelRadius:20})),i.a.createElement("div",null,"As you can see, if people voluntarily self-quarantine (once they show symptoms) and are strict about isolating themselves, the spread can be mitigated. Unfortunately, because patients are contagious during the incubation period (before they have a chance to notice their own symptoms), it's hard to stop the spread entirely."),i.a.createElement("div",null,"For most diseases, self-quarantine won't solve the problem on its own. Rather, it's one tool among many (including better hygiene, social distances, travel restrictions, etc.) that ",i.a.createElement("em",null,"all together")," can bring an outbreak under control. A big lesson here is that every strategy complements every other strategy."),i.a.createElement("div",null,i.a.createElement("h3",null,"Full model")),i.a.createElement(T,null,i.a.createElement(A,{gridRows:101,gridCols:101,hospitalCapacityPct:.05,nodeSize:5,nug:5,randomSeed:100,showAliveFraction:!0,showAllControls:!0,showDeaths:!0,speed:1})))}},{key:"renderSubscribeForm",value:function(){return i.a.createElement("form",{method:"post",action:"https://meltingasphalt.us8.list-manage.com/subscribe/post?u=0bc9d741e167733d20c520ea6&id=57ebd9b4a6",id:"mc4wp-form-1",className:"form mc4wp-form"},i.a.createElement("input",{type:"email",id:"mc4wp_email",name:"EMAIL",placeholder:"Enter your email",required:!0}),i.a.createElement("input",{type:"submit",value:"Subscribe"}),i.a.createElement("textarea",{name:"_mc4wp_required_but_not_really",style:{display:"none"}}),i.a.createElement("input",{type:"hidden",name:"_mc4wp_form_submit",value:"1"}),i.a.createElement("input",{type:"hidden",name:"_mc4wp_form_instance",value:"1"}),i.a.createElement("input",{type:"hidden",name:"_mc4wp_form_nonce",value:"8a45344b67"}))}},{key:"renderEndOfPostDivider",value:function(e){var t="",a=i.a.createElement("span",null,"\u2014\u2014");return e&&(t="Originally published March 16, 2020.",a=i.a.createElement("img",{src:"https://meltingasphalt.com/wp-content/themes/responsive/core/images/flourish.svg",width:50,alt:"\u2014\u2014"})),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("div",{className:"end-of-post-divider"},a),i.a.createElement("div",{className:"signature-line"},t))}},{key:"renderHeader",value:function(){return i.a.createElement("div",{id:"header"},i.a.createElement("div",{id:"logo",className:"branded"},i.a.createElement("span",{className:"site-name"},i.a.createElement("a",{href:"https://meltingasphalt.com/",title:"Melting Asphalt",rel:"home"},i.a.createElement("img",{id:"nav-logo",src:"https://meltingasphalt.com/wp-content/themes/responsive/core/images/ma.svg"}),"\xa0\xa0Melting Asphalt"))))}},{key:"render",value:function(){return i.a.createElement("div",{className:"main-container"},i.a.createElement("div",{className:"header"},this.renderHeader()),i.a.createElement("div",{className:"blank-l"}),i.a.createElement("div",{className:"content"},this.renderMainPost()),i.a.createElement("div",{className:"blank-r"}),i.a.createElement("div",{className:"footer"}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},43:function(e,t,a){},66:function(e,t,a){e.exports=a(178)},71:function(e,t,a){}},[[66,2,1]]]);
//# sourceMappingURL=main.908c4d96.chunk.js.map